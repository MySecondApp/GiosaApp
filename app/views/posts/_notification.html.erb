<script>
  // Ejecutar cuando el DOM estÃ© listo o inmediatamente si ya estÃ¡ listo
  (function() {
    console.log('ðŸ”” Notification partial loaded with:', '<%= j(title) %>');
    function showNotification() {
      console.log('ðŸ“¢ Dispatching notification event');
      const event = new CustomEvent('notification:show', {
        detail: {
          message: '<%= j(message) %>',
          type: '<%= type %>',
          title: '<%= j(title) %>',
          duration: 3000
        }
      });
      window.dispatchEvent(event);
      
      // Redirigir despuÃ©s de mostrar la notificaciÃ³n
      <% if defined?(redirect_url) && redirect_url %>
        setTimeout(() => window.location.href = '<%= redirect_url %>', 1500);
      <% end %>
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', showNotification);
    } else {
      showNotification();
    }
  })();
</script>
